language: java
dist: trusty
jdk:
  - oraclejdk8

sudo: required
install: true

notifications:
  email: false

branches:
  only:
  - master
  - development

services:
  - docker

addons:
  sonarcloud:
    organization: "tbmelabs-github"
    token:
      secure: "XicCVyfquanzSNztOKMG93NBCcnhlFc3XNOqZ9rpPiWVLFGEoxXcLHoKRoiXihklMumqgfRJoRMmD3NIFB4Fn3DAzo4ZUhvxgoaNjM8UcGiUhwrtyu0Xfn0V9vpNVPVDZiAeW8vG3tNdxa2k9Ro1jxD10KdcrxOObzofcqSyIJK/vko7rdL5RDjHx+XlJCl0TAgInCNQkiVyLVKavCvq3rWN7OKarlWNzMIPUV1DHNEN3Yoo9A1AcQu9rVMCwUs6afOUU2jCCxUenDxxyv8g5QYPkyeiUFsNVr6xo6uF7LfasTSBeKHTrDAiqC11nOcqg/QRYGrRa0HJI3Mgc/8L1BjFR/spTOJGh/bn4hcWgIZNYtd2MNh/7GqRtLedb4vmGSlfLSu5/YTODQOXlppFyvI+n+yNInCdsaySFWswAts7SucUt/ggmx2tsIoi3yvoCEtfCvClhBO4y0UDlgo14RQ64WzmEkchfE8NTmfeUK/f5Aa9G6u58OSys4gm+y/Xk2CMcictC0T2fenHIbEnwyJUrRq84sXbsZsz9qtqNR795kX3DALwBxk+aF3mjxI57taKmpt5G5vrW1A4XkcAjE/+fGCj1q7mvLQz/w8x0DcB6AHHir9OYMYG1X0X1c3qYlqU9nQiztJ543/h7C9VKSA5J7P1RgVcg8tOGEdc7nw="

deploy:
  - provider: script
    script: mvn deploy -DskipTests -X
    on:
      all_branches: true

env:
  global:
    - secure: "HX/Y259p1wydKKhtf5/2xiIoeHlbyWxW+gY/0oLxAB/oUqfr1ZWp8efGzCssgtg/C1Q4RKQcxiQfyHASI+3zM9wt3AsAXZymL1LeVSo2SeVP27PuDGq+MwgrbLdSybQgPYU7y9fteNII3aCpOjsZ9/KvcQafVg/uWF+GJ6166fvbX1p30b2PS+mmuCgnUnVsAXpPCPnHvMPFi3o5lkfema8cre7mkztSXqn44RcBhWxqOqiL8l5oSjAgtEnKL6U/L8GWjLePogYGxKQvtpUWArz3n2WhC0U3uCTuhPBilQp6BMa1nPiqhEn7MtZMycFiCebUdQzixFs6/TFx+kanP9D4oT9B8Y8wy8A3qRrJCFhtkH9AFsVpiRCCluxqJ9/PcowcG9RD/OIpsoZO+1JKRb2RCM8WyclciT8iNomegGuVTTqzykO1H75O3nXDND+3X9/k7GfS7f+kJPgpry65KTTwKutRjQR5xv+Rq5TSlLmwzINcBunhddK3hS1cpvHUEqsNFkSzurDnjJlhVmId0WTk16PcBlxB8BKYZdKss74QgOay4F30H+JBwhxeepchS5Pu2ns7YnuVai7r55K4XxtaZ36YgdAaeHZpD5KMr8Cmi8XoIHViXTqsl/hsX5whLnAwcHTJnqtIjlgnliciZj2pJEMWe7c45stRtV4TTEU="
    # ^^ DOCKER_USERNAME
    - secure: "ZhM1ujYw+gFeJeGIGaIknvcFFtsd6sCYV77bN7AzYOhjA88D6+chjYEUTja4p8G1lq4Iwr+OzuAQSpuVMILmq4bvxNBHWM8rUFWbJPRD97JwwFYScxy+7b5fvAf76M1tr5cVPMoNIYh0Pwb7vXf+uL3Ym8yAr4VbQYvAsSx9zlQJP+bxGTDKzeV/IXZvsfK/hU7WFrFARSg3Cb63dNqyffFLJj0dB2e0nGd1GFKxdDupcN8jdffFPkkBfkmHCWn9pCkBamEiwd74SGUTe8wH0QE1VUE0N2QcdmrSxOSmToJxsk4eJ7mGS8bHdTHC+OSInZfzT6xcTqg/03jjV0s3kVj6jsxitRESh9QrHX/s87lYJTasMrH5ZPbaui6Y/DxFcocx5z3KN2/t974OnaOlsWcPkSFOIeJnv2o9HioPM2jc7TFxZpaIIuEAsnT3doGw9v9yMMN98igvef7LxesJ1sHa8Y+cdloE7X9S4f+qrEFF1mdoHuyPhgfeRwTDeDqbZoDENC1rnITsWRHO1Fp5mOPiYPmBYr6Il5kRaTmYdE+AyxrXdrk5S01pQri0P/o2wKqZW/57B8aPKM+vpy3/vmlneZJk4kdgC1lWEUkC9liJ5Zohlv/yl45Y/oGrn8hZJJHpsbIOf0kPJsO0sjIAlzssSKXd4EnglnfG7OPkQ+Q="
    # ^^ DOCKER_PASSWORD

before_script:
  - cp .travis.settings.xml $HOME/.m2/settings.xml
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin

script:
  - mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar

cache:
  directories:
    - "$HOME/.cache"
    - '$HOME/.m2/repository'
    - '$HOME/.sonar/cache'
